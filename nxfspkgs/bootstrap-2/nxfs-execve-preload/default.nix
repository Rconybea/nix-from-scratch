let
  nxfs-toolchain-wrapper-1 = import ../../bootstrap-1/nxfs-toolchain-wrapper-1/default.nix;
  nxfs-bash-2              = import ../../bootstrap-2/nxfs-bash-2/default.nix;
  nxfs-sed-2               = import ../../bootstrap-2/nxfs-sed-2/default.nix;
  nxfs-coreutils-2         = import ../../bootstrap-2/nxfs-coreutils-2/default.nix;
  nxfs-toolchain-1         = import ../../bootstrap-1/nxfs-toolchain-1/default.nix;
  nxfs-sysroot-1           = import ../../bootstrap-1/nxfs-sysroot-1/default.nix;
in

derivation {
  name              = "nxfs-execve-preload";
  system            = builtins.currentSystem;

  gcc_wrapper       = nxfs-toolchain-wrapper-1;
  bash              = nxfs-bash-2;
  sed               = nxfs-sed-2;
  coreutils         = nxfs-coreutils-2;
  toolchain         = nxfs-toolchain-1;
  sysroot           = nxfs-sysroot-1;

  builder           = "${nxfs-bash-2}/bin/bash";
  args              = [ ./builder.sh ];

  redirect_execve_c = ./redirect_execve.c;
}
